<!DOCTYPE html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">

    

    

    <title>Thread类 | 寻找真实</title>
    <meta name="author" content="LaoJQ">
    <meta name="version" content="1.0.0">
    <meta name="keywords" content>
    <meta name="description" content="Thread 是程序中的执行线程。Java 虚拟机允许应用程序并发地运行多个执行线程这个类直接继承自Object并实现Runnable接口,是线程类的顶级父类版本源自JDK1.0字段Thread类有三个表示线程优先级的字段,其设值范围为1-10;默认优先级为5。并不是某个优先级高,那么它就必定先执行。优先级高仅表示获取CPU时间片的几率高,但要多次运行才能看到效果。因为存在随机性123public static final int MIN_PRIORITY = 1;public...">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">

    
    <link rel="alternate" href="/atom.xml" title="寻找真实" type="application/atom+xml">
    
    
    <link rel="icon" href="/images/favicon.ico">
    

    <link rel="stylesheet" href="/css/style.css">
</head>
<body>

    <main class="app">
        <header class="header clearfix">
    <div id="nav" class="nav">
    <div class="nav-mobile">
        <button id="open-panel" class="open-panel nav-mobile-item"><i class="icon-documents"></i></button>
        <h1 class="nav-mobile-title nav-mobile-item">寻找真实</h1>
        <button id="open-menus" class="open-panel nav-mobile-item"><i class="icon-library"></i></button>
    </div>

    <nav id="nav-inner" class="nav-inner">
        
            <a class="nav-item" href="/">
                <span class="nav-text">首页</span>
            </a>
        
            <a class="nav-item" href="/categories/front-end">
                <span class="nav-text">前端</span>
            </a>
        
            <a class="nav-item" href="/categories/back-end">
                <span class="nav-text">后端</span>
            </a>
        
            <a class="nav-item" href="/categories/Java">
                <span class="nav-text">Java</span>
            </a>
        
            <a class="nav-item" href="/tags">
                <span class="nav-text">标签</span>
            </a>
        
            <a class="nav-item" href="/archives">
                <span class="nav-text">归档</span>
            </a>
        
            <a class="nav-item" href="/atom.xml">
                <span class="nav-text">订阅</span>
            </a>
        
            <a class="nav-item" href="/about">
                <span class="nav-text">关于</span>
            </a>
        
    </nav>
</div>

    <aside id="aside" class="aside">
    <div id="aside-mask" class="aside-mask"></div>
    <div id="aside-inner" class="aside-inner">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="icon-search-stroke"></i></button><input type="hidden" name="sitesearch" value="https://liao1816391.github.io.git"></form>

        
        
        
        

        
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#字段"><span class="toc-number">1.</span> <span class="toc-text">字段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#常用构造"><span class="toc-number">2.</span> <span class="toc-text">常用构造</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#常用方法"><span class="toc-number">3.</span> <span class="toc-text">常用方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#线程名称"><span class="toc-number">3.1.</span> <span class="toc-text">线程名称</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#当前线程"><span class="toc-number">3.2.</span> <span class="toc-text">当前线程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#核心方法"><span class="toc-number">3.3.</span> <span class="toc-text">核心方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#优先级相关"><span class="toc-number">3.4.</span> <span class="toc-text">优先级相关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#判断相关"><span class="toc-number">3.5.</span> <span class="toc-text">判断相关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#线程控制"><span class="toc-number">3.6.</span> <span class="toc-text">线程控制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#休眠"><span class="toc-number">3.6.1.</span> <span class="toc-text">休眠</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#礼让"><span class="toc-number">3.6.2.</span> <span class="toc-text">礼让</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#加入"><span class="toc-number">3.6.3.</span> <span class="toc-text">加入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#后台线程-守护线程"><span class="toc-number">3.6.4.</span> <span class="toc-text">后台线程(守护线程)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#中断-重要"><span class="toc-number">3.6.5.</span> <span class="toc-text">中断(重要)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#线程组"><span class="toc-number">3.7.</span> <span class="toc-text">线程组</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#相关习题"><span class="toc-number">4.</span> <span class="toc-text">相关习题</span></a></li></ol>
        
    </div>
</aside>

</header>

        <div id="content" class="content"><article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            Thread类
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://liao1816391.github.io.git/2019/10/06/Java/Thread/Thread/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2019-10-06T03:16:14.000Z" itemprop="datePublished">2019-10-06</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/tags/Thread/">Thread</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <pre><code>Thread 是程序中的执行线程。Java 虚拟机允许应用程序并发地运行多个执行线程
这个类直接继承自Object并实现Runnable接口,是线程类的顶级父类
版本源自JDK1.0</code></pre><a id="more"></a>

<h2 id="字段"><a href="#字段" class="headerlink" title="字段"></a>字段</h2><pre><code>Thread类有三个表示线程优先级的字段,其设值范围为1-10;默认优先级为5。
并不是某个优先级高,那么它就必定先执行。
优先级高仅表示获取CPU时间片的几率高,但要多次运行才能看到效果。因为存在随机性</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MIN_PRIORITY = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> NORM_PRIORITY = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAX_PRIORITY = <span class="number">10</span>;</span><br></pre></td></tr></table></figure>

<h2 id="常用构造"><a href="#常用构造" class="headerlink" title="常用构造"></a>常用构造</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Thread</span><span class="params">()</span></span>;<span class="comment">//默认生成名称的形式为"Thread"+n</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Thread</span><span class="params">(String name)</span></span>;<span class="comment">//在实例的时候设置线程名字</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Thread</span><span class="params">(Runnable target)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Thread</span><span class="params">(Runnable target, String name)</span></span>;</span><br><span class="line"><span class="comment">//以下是线程组相关,为实例的线程分配线程组group</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Thread</span><span class="params">(ThreadGroup group, String name)</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Thread</span><span class="params">(ThreadGroup group, Runnable target)</span> </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Thread</span><span class="params">(ThreadGroup group, Runnable target, String name)</span></span></span><br><span class="line"><span class="function"><span class="comment">//stackSize - 新线程的预期堆栈大小，为零时表示忽略该参数</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Thread</span><span class="params">(ThreadGroup group, Runnable target, String name, <span class="keyword">long</span> stackSize)</span></span></span><br></pre></td></tr></table></figure>

<h2 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h2><h3 id="线程名称"><a href="#线程名称" class="headerlink" title="线程名称"></a>线程名称</h3><pre><code>java为线程名称提供了get/set方法,设置名称时会先调用checkAccess()检查当前线程有无该线程的修改权限。
    如果不能修改名称,抛出 SecurityException</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">getName</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>

<pre><code>简单的测试案例 ： 
    以下代码输出结果为Thread-0、modify、hello Thread;</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Thread thread1 = <span class="keyword">new</span> Thread();</span><br><span class="line">Thread thread2 = <span class="keyword">new</span> Thread(<span class="string">"hello Thread"</span>);</span><br><span class="line">System.out.println(thread1.getName());</span><br><span class="line">thread1.setName(<span class="string">"modify"</span>);</span><br><span class="line">System.out.println(thread1.getName());</span><br><span class="line">System.out.println(thread2.getName());</span><br></pre></td></tr></table></figure>


<pre><code>通过调试可以知道调用无参构造默认输出的名字是Thread-0,但是并未设置名字。
此时查看Thread类的源码查看其无参构造与getName方法(jdk9)
可以发现默认给无参设置了名字Thread+(数字),这个数字是随着无参对象的创建而递增的</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> threadInitNumber;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">volatile</span> String name;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Thread</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	init(<span class="keyword">null</span>, <span class="keyword">null</span>, <span class="string">"Thread-"</span> + nextThreadNum(), <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> <span class="keyword">int</span> <span class="title">nextThreadNum</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> threadInitNumber++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ThreadGroup g, Runnable target, String name,</span></span></span><br><span class="line"><span class="function"><span class="params">      <span class="keyword">long</span> stackSize, AccessControlContext acc,</span></span></span><br><span class="line"><span class="function"><span class="params">      <span class="keyword">boolean</span> inheritThreadLocals)</span> </span>&#123;</span><br><span class="line">	...</span><br><span class="line">	<span class="keyword">this</span>.name = name;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="当前线程"><a href="#当前线程" class="headerlink" title="当前线程"></a>当前线程</h3><pre><code>Thread类提供了一个获取正在执行当前代码的线程对象引用的方法currentThread()
    注意 : 这个不是返回的代码类对象线程,而是正在执行的线程。
如果是main方法内获取,那么获取的是main线程。</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Thread <span class="title">currentThread</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>


<h3 id="核心方法"><a href="#核心方法" class="headerlink" title="核心方法"></a>核心方法</h3><pre><code>线程类两个最基础的方法run()与start(),其中run()用于放置被线程执行的代码。
run()仅仅是一个普通方法,而start() 用于启动线程,并由JVM执行其run()。
    注意 : 如果该线程已经启动,再次执行start()将抛出 IllegalThreadStateException</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>


<pre><code>简单的测试案例 :</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">	Thread thread1 = <span class="keyword">new</span> Thread()&#123;</span><br><span class="line">	    <span class="meta">@Override</span></span><br><span class="line">	    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">10</span>;i++)</span><br><span class="line">	            System.out.println(currentThread().getName()+<span class="string">" t "</span>+i);</span><br><span class="line">	    &#125;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="comment">// thread1.run();</span></span><br><span class="line">	<span class="comment">// thread1.start();</span></span><br><span class="line">	<span class="comment">// thread1.start();</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;<span class="number">10</span>;i++)</span><br><span class="line">	    System.out.println(Thread.currentThread().getName()+<span class="string">" "</span>+i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<pre><code>首先是单独执行run(),由于没有启动线程。那么相当于执行thread1对象的run()。
但是,这个线程是main执行的。
所以我们可以看到main线程先执行run()打印了十次,然后它自己打印了十次</code></pre><p><img src="/images/Java/Thread/Thread_run.PNG" alt></p>
<pre><code>然后单独执行start(),可以看到无参构造的Thread-0与main同时执行。
这就实现了多个功能同时执行</code></pre><p><img src="/images/Java/Thread/Thread_start.PNG" alt></p>
<pre><code>最后执行thread1对象的start()两次,可以发现抛出异常.main线程被JVM终止了</code></pre><p><img src="/images/Java/Thread/Thread_start_Exception.PNG" alt></p>
<h3 id="优先级相关"><a href="#优先级相关" class="headerlink" title="优先级相关"></a>优先级相关</h3><pre><code>java为线程的优先级提供了get/set方法,但是设置优先级不要超出设置范围。
如果想让线程的执行几率更高,那么将它的优先级设置得更大
    如果设置超出设置访问,抛出 IllegalArgumentException</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">getPriority</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">setPriority</span><span class="params">(<span class="keyword">int</span> newPriority)</span></span></span><br></pre></td></tr></table></figure>

<h3 id="判断相关"><a href="#判断相关" class="headerlink" title="判断相关"></a>判断相关</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">checkAccess</span><span class="params">()</span><span class="comment">//判定当前运行的线程是否有权修改该线程,注意返回值类型</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">interrupted</span><span class="params">()</span><span class="comment">//测试当前线程是否已经中断</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isInterrupted</span><span class="params">()</span><span class="comment">//测试线程是否已经中断</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">isAlive</span><span class="params">()</span><span class="comment">//测试线程是否处于活动状态。线程已经启动且尚未终止,为活动状态</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">isDaemon</span><span class="params">()</span><span class="comment">//测试该线程是否为守护线程</span></span></span><br></pre></td></tr></table></figure>

<h3 id="线程控制"><a href="#线程控制" class="headerlink" title="线程控制"></a>线程控制</h3><h4 id="休眠"><a href="#休眠" class="headerlink" title="休眠"></a>休眠</h4><pre><code>在指定的毫秒数内让当前正在执行的线程休眠</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sleep</span><span class="params">(<span class="keyword">long</span> millis)</span><span class="keyword">throws</span> InterruptedException</span></span><br></pre></td></tr></table></figure>

<h4 id="礼让"><a href="#礼让" class="headerlink" title="礼让"></a>礼让</h4><pre><code>暂停当前正在执行的线程对象，并执行其他线程
可以让多个线程的执行更和谐,但是无法保证每个线程一次的来(会接近每个线程执行一次的顺序)</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">yield</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>

<h4 id="加入"><a href="#加入" class="headerlink" title="加入"></a>加入</h4><pre><code>等待该线程终止,也就是调用对象执行超时时间结束后面的代码才能被执行
不设置超时时间或者设置为0,代表后面的代码要等待这个线程执行完</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">join</span><span class="params">()</span><span class="keyword">throws</span> InterruptedException <span class="comment">//当抛出异常,中断状态被清除</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">join</span><span class="params">(<span class="keyword">long</span> millis)</span><span class="keyword">throws</span> InterruptedException</span></span><br></pre></td></tr></table></figure>


<pre><code>简单的测试案例 :</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Daemon</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MyThread my1 = <span class="keyword">new</span> MyThread();</span><br><span class="line">        MyThread my2 = <span class="keyword">new</span> MyThread();</span><br><span class="line">        MyThread my3 = <span class="keyword">new</span> MyThread();</span><br><span class="line">        my1.setName(<span class="string">"曹操"</span>);</span><br><span class="line">        my2.setName(<span class="string">"典韦"</span>);</span><br><span class="line">        my3.setName(<span class="string">"许褚"</span>);</span><br><span class="line">        my1.start();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            my1.join(<span class="number">500</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        my2.start();</span><br><span class="line">        my3.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">200</span>; i++) &#123;</span><br><span class="line">            System.out.println(<span class="keyword">this</span>.getName() + <span class="string">" "</span>+ i);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">10</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<pre><code>可以看到在500毫秒过后,三个线程开始一起执行了
如果想让线程&quot;曹操&quot;先执行完,那么设置0毫秒或者不设置
如果将join放置在my2.start();后面,那么my2这个线程也被启动了。
其实发现,设定指定时长,join和sleep效果其实差不多；
    但是它可以设置某个线程执行完毕后其他线程再执行,而sleep就要估算时间了</code></pre><p><img src="/images/Java/Thread/Thread_join.PNG" alt></p>
<h4 id="后台线程-守护线程"><a href="#后台线程-守护线程" class="headerlink" title="后台线程(守护线程)"></a>后台线程(守护线程)</h4><pre><code>将该线程标记为守护线程或用户线程。当正在运行的线程都是守护线程时,Java 虚拟机退出
该方法必须在启动线程前调用,其次当所有非守护线程结束,守护线程不一定会马上结束</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">setDaemon</span><span class="params">(<span class="keyword">boolean</span> on)</span></span></span><br></pre></td></tr></table></figure>

<pre><code>简单的测试案例 :</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Daemon</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MyThread my1 = <span class="keyword">new</span> MyThread();</span><br><span class="line">        MyThread my2 = <span class="keyword">new</span> MyThread();</span><br><span class="line">        MyThread my3 = <span class="keyword">new</span> MyThread();</span><br><span class="line">        my1.setName(<span class="string">"关羽"</span>);</span><br><span class="line">        my2.setName(<span class="string">"张飞"</span>);</span><br><span class="line">        my3.setName(<span class="string">"刘备"</span>);</span><br><span class="line">        my1.setDaemon(<span class="keyword">true</span>);</span><br><span class="line">        my2.setDaemon(<span class="keyword">true</span>);</span><br><span class="line">        System.out.println(my1.isDaemon());</span><br><span class="line">        System.out.println(my3.isDaemon());</span><br><span class="line">        my1.start();</span><br><span class="line">        my2.start();</span><br><span class="line">        my3.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">200</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.getName().equals(<span class="string">"刘备"</span>) &amp;&amp; i&gt;<span class="number">2</span>) <span class="keyword">break</span>;</span><br><span class="line">            System.out.println(<span class="keyword">this</span>.getName() + <span class="string">" "</span>+ i);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.yield();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/images/Java/Thread/Thread_Daemon.PNG" alt></p>
<h4 id="中断-重要"><a href="#中断-重要" class="headerlink" title="中断(重要)"></a>中断(重要)</h4><pre><code>第一是stop()具有固有不安全性,过于暴力,停止执行后面的代码都没有执行.finally块的代码能被执行到
然后是interrupt()这种中断方式比较安全,能保证异常的抛出,但是这是一个抛出异常的中断
其次,中断状态有时间限制???
    如果当前线程无法修改该线程,则抛出 SecurityException</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span><span class="comment">//强迫线程停止执行,以过时</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">interrupt</span><span class="params">()</span><span class="comment">//中断线程,把线程状态终止并抛出InterruptedException</span></span></span><br></pre></td></tr></table></figure>


<pre><code>简单的测试案例 :</code></pre><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Thread my = <span class="keyword">new</span> Thread()&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (!isInterrupted()) &#123;</span><br><span class="line">            System.out.println(<span class="string">"我现在要休息10秒 "</span> + <span class="keyword">new</span> Date());</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">700</span>);</span><br><span class="line">                System.out.println(<span class="string">"我休息好了"</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                System.out.println(<span class="string">"休息结束了,出现了异常 "</span> + <span class="keyword">new</span> Date());</span><br><span class="line">                interrupt();</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">"带上装备,开工! "</span> + <span class="keyword">new</span> Date());</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">"开始工作"</span> + <span class="keyword">new</span> Date());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">my.start();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">    <span class="comment">//my.stop();</span></span><br><span class="line">    <span class="comment">//my.interrupt();</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<pre><code>通过测试可以发现,stop()会中断当前线程的执行并不会抛出异常
如果在try块里面中断,还是会执行finally代码块</code></pre><p><img src="/images/Java/Thread/Thread_stop.PNG" alt></p>
<pre><code>interrupt()会中断当前线程的执行,但是会把run方法里面的代码执行完。
如果在try代码块内被中断,try块代码中断之后的代码无法执行
    然后抛出InterruptException,走正常的try-catch-finally流程
但是注意 : 中断状态貌似有时间限制,在run()自中断之后设置休眠,代码无限循环
    故而在main()里面获取my的中断状态可能出现不同结果,
        获取的时候my还没中断,那么false
        中断了,且在有效时间内,true
        中断了,超过有效时间,false
    这里还要继续深入,未完待续....</code></pre><p><img src="/images/Java/Thread/Thread_interrupt.PNG" alt></p>
<h3 id="线程组"><a href="#线程组" class="headerlink" title="线程组"></a>线程组</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> ThreadGroup <span class="title">getThreadGroup</span><span class="params">()</span><span class="comment">//返回该线程所属的线程组,若该线程已终止则返回null</span></span></span><br></pre></td></tr></table></figure>

<a href="/2019/10/07/Java/Thread/ThreadGroup/" title="线程组">线程组</a>

<h2 id="相关习题"><a href="#相关习题" class="headerlink" title="相关习题"></a>相关习题</h2><a href="/2019/10/06/Java/Thread/Exercise/" title="线程练习">线程练习</a>
        
    </section>
</article>



<div class="comments">
    <div id="comments"></div>
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
    new Gitalk({
        clientID: "7fbe80427f54741e289f",
        clientSecret: "f34ed5fd92e54c9000bd37ba951948cb939deff5",
        repo: "liao1816391.github.io",
        owner: "LaoJQ",
        admin: ["LaoJQ"],
        id: "2019/10/06/Java/Thread/Thread",
        distractionFreeMode: true,
        title: "Thread类",
        body: "https://liao1816391.github.io.git/2019/10/06/Java/Thread/Thread/",
        labels: ["Thread"]
    }).render('comments');
    </script>
</div>

</div>
        <footer class="footer">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme by <a href="https://github.com/sanonz/hexo-theme-concise" target="_blank">Concise</a>

    
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?e4027971a230b210f4671f485b33846a";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
    
</footer>

    </main>

    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/1.9.0/jquery.min.js"></script>
    <script type="text/javascript">
    $(function() {
        var nodes = {
            nav: $('#nav'),
            aside: $('#aside'),
            asideInner: $('#aside-inner'),
            navInner: $('#nav-inner')
        };

        var doing = false;
        nodes.asideInner.on('webkitAnimationEnd mozAnimationEnd oAnimationEnd oanimationend animationend', function() {
            if (nodes.aside.hasClass('mobile-open')) {
                nodes.aside.removeClass('mobile-open');
            } else {
                nodes.aside.removeClass('mobile-close panel-show');
            }
            doing = false;
        });
        $('#open-panel, #aside-mask').on('click', function() {
            if (doing) {
                return;
            }
            
            if (nodes.aside.hasClass('panel-show')) {
                nodes.aside.addClass('mobile-close');
            } else {
                nodes.aside.addClass('mobile-open panel-show');
            }
        });
        $('#open-menus').on('click', function() {
            nodes.navInner.slideToggle();
        });

        if (window.innerWidth <= 960) {
            setTimeout(function() {
                nodes.navInner.slideUp();
            }, 3000);
        }
    });
    </script>
    
        <script type="text/javascript" src="/js/scrollspy.min.js"></script>
        <script type="text/javascript">
        $(document.body).scrollspy({target: '#aside-inner'});
        </script>
    

</body>
</html>
